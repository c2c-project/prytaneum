"use strict";(self.webpackChunk_app_docs=self.webpackChunk_app_docs||[]).push([[767],{8840:function(e,t,n){n.d(t,{Zo:function(){return p},kt:function(){return u}});var a=n(9703);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function r(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var l=a.createContext({}),c=function(e){var t=a.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):r(r({},t),e)),n},p=function(e){var t=c(e.components);return a.createElement(l.Provider,{value:t},e.children)},g={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},d=a.forwardRef((function(e,t){var n=e.components,i=e.mdxType,o=e.originalType,l=e.parentName,p=s(e,["components","mdxType","originalType","parentName"]),d=c(n),u=i,m=d["".concat(l,".").concat(u)]||d[u]||g[u]||o;return n?a.createElement(m,r(r({ref:t},p),{},{components:n})):a.createElement(m,r({ref:t},p))}));function u(e,t){var n=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var o=n.length,r=new Array(o);r[0]=d;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s.mdxType="string"==typeof e?e:i,r[1]=s;for(var c=2;c<o;c++)r[c]=n[c];return a.createElement.apply(null,r)}return a.createElement.apply(null,n)}d.displayName="MDXCreateElement"},1471:function(e,t,n){n.r(t),n.d(t,{assets:function(){return p},contentTitle:function(){return l},default:function(){return u},frontMatter:function(){return s},metadata:function(){return c},toc:function(){return g}});var a=n(6738),i=n(8832),o=(n(9703),n(8840)),r=["components"],s={},l="E2E Testing",c={unversionedId:"testing/e2e-testing",id:"testing/e2e-testing",title:"E2E Testing",description:"Pattern",source:"@site/docs/testing/e2e-testing.md",sourceDirName:"testing",slug:"/testing/e2e-testing",permalink:"/prytaneum/docs/testing/e2e-testing",draft:!1,editUrl:"https://github.com/c2c-project/prytaneum/tree/dev/app/docs/docs/testing/e2e-testing.md",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Learning Resources",permalink:"/prytaneum/docs/learning-resources"}},p={},g=[{value:"Pattern",id:"pattern",level:2},{value:"Landing Page Login Example",id:"landing-page-login-example",level:2},{value:"Without POM",id:"without-pom",level:3},{value:"Our Pattern",id:"our-pattern",level:3},{value:"Landing Page Class",id:"landing-page-class",level:4},{value:"A Landing Page Test",id:"a-landing-page-test",level:4}],d={toc:g};function u(e){var t=e.components,n=(0,i.Z)(e,r);return(0,o.kt)("wrapper",(0,a.Z)({},d,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"e2e-testing"},"E2E Testing"),(0,o.kt)("h2",{id:"pattern"},"Pattern"),(0,o.kt)("p",null,"For our e2e tests we are using the ",(0,o.kt)("a",{parentName:"p",href:"https://playwright.dev/docs/pom"},"Page Object Model")," (POM). The idea is for the class to handle all the locators and expects, abstracting each step of the testing to make the tests themselves clear and easy to follow. We also want to design the tests in a user flow centric way, putting focus on ensuring a user can perform a given action without encountering issues along the way."),(0,o.kt)("h2",{id:"landing-page-login-example"},"Landing Page Login Example"),(0,o.kt)("p",null,"We want to test that a user can log in from the landing page and be redirected to the correct protected route. Typically without POM in playwright this would be done via direct playwright page interactions"),(0,o.kt)("h3",{id:"without-pom"},"Without POM"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-ts"},"test('I can login from the app bar', async ({ page }) => {\n    await page.goto('/'),\n        await page.locator('text=Login').click(),\n        await page.locator('input[type=\"email\"]').fill('test@prytaneum.io'),\n        await page.locator('input[type=\"password\"]').click(),\n        await page.locator('input[type=\"password\"]').fill('password'),\n        await Promise.all([\n            page.waitForNavigation(),\n            page.locator('div[role=\"dialog\"] button:has-text(\"Login\")').click(),\n        ]);\n    await expect(page).toHaveURL('/organizations/me');\n});\n")),(0,o.kt)("p",null,"While this test does pass and work, it is not obvious at a glance what is going on with each step, and for longer, more complicated selectors, it can become even more difficult to follow."),(0,o.kt)("h3",{id:"our-pattern"},"Our Pattern"),(0,o.kt)("p",null,"Rather than putting all these page locators and interactions within the test, we can move them to a class based on the page we are testing. This way we can clearly dictate each step of our test in plain english, thus minimizing confusion."),(0,o.kt)("h4",{id:"landing-page-class"},"Landing Page Class"),(0,o.kt)("p",null,"When constructing we can locate all the components we want to interact with or ensure is visible/hidden for the user.\nAs for the actions, they can all be represented as methods."),(0,o.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},"Even if the component is not currently in the DOM you can still set it in the constructor since the locator is dynamic."))),(0,o.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},"Keep the methods small and in the scope of one specific task as shown in the example below. No one method should be performing multiple actions."))),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-ts"},"export class PlaywrightLandingPage {\n    readonly page: Page;\n    readonly appBarLoginButton: Locator;\n    // Constructor\n    constructor(page: Page) {\n        this.page = page;\n        this.appBarLoginButton = page.locator('[data-test-id=\"appbar-login-button\"]');\n    }\n    // Page Actions\n    async goto() {\n        await this.page.goto('/');\n    }\n    async clickOnLogin() {\n        await this.appBarLoginButton.click();\n    }\n    async fillInEmail(email: string) {\n        const emailInput = this.page.locator('input[type=\"email\"]');\n        await expect(emailInput).toBeVisible();\n        await emailInput.fill(email);\n    }\n    async fillInPassword(password: string) {\n        const passwordInput = this.page.locator('input[type=\"password\"]').first();\n        await expect(passwordInput).toBeVisible();\n        await passwordInput.fill(password);\n    }\n    async submitLoginForm() {\n        const loginButton = this.page.locator('div[role=\"dialog\"] button:has-text(\"Login\")');\n        await expect(loginButton).toBeVisible();\n        await Promise.all([this.page.waitForNavigation(), loginButton.click()]);\n    }\n    // Route Check\n    async amLoggedIn() {\n        await expect(this.page).toHaveURL('/organizations/me');\n    }\n}\n")),(0,o.kt)("h4",{id:"a-landing-page-test"},"A Landing Page Test"),(0,o.kt)("p",null,"With the class set up, the tests can be performed as shown below, giving a clear sequence of actions performed on the page as well as validating the end result. Also note that the test naming convention follows the user flow philosophy. We want to know that I (The user) can perform said action."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-ts"},"test('I can login from the app bar', async ({ page }) => {\n    const landing = new PlaywrightLandingPage(page);\n    await landing.goto();\n    await landing.clickOnLogin();\n    await landing.fillInEmail('test@example.com');\n    await landing.fillInPassword('Password1!');\n    await landing.submitLoginForm();\n    await landing.amLoggedIn();\n});\n")))}u.isMDXComponent=!0}}]);